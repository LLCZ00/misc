<#
WIP
Script for downloading malware analysis tools for windows 10
Includes:
pestudio
idapro (free)
x64 dbg
sysinternals
regshot
wireshark
Detect-it-easy
ExplorerSuite (CFF Explorer)
#>

$sites =
'https://www.winitor.com/tools/pestudio/current/pestudio.zip',
'https://out7.hex-rays.com/files/idafree77_windows.exe',
'https://github.com/x64dbg/x64dbg/releases/download/snapshot/snapshot_2022-04-11_01-01.zip',
'https://download.sysinternals.com/files/SysinternalsSuite.zip',
'https://sourceforge.net/projects/regshot/files/latest/download',
'https://1.eu.dl.wireshark.org/win64/Wireshark-win64-3.6.3.exe',
'https://github.com/horsicq/DIE-engine/releases/download/3.04/die_win64_portable_3.04.zip',
'https://ntcore.com/files/ExplorerSuite.exe'

$names = 
'pestudio.zip',
'idafree.exe',
'x64dbg.zip',
'SysinternalsSuite.zip',
'regshot.7z',
'Wireshark-win64-3.6.3.exe',
'die_win64_portable_3.04.zip',
'ExplorerSuite.exe'


$dpath = [System.Environment]::GetFolderPath("Desktop")
$ToolsPath = "${dpath}\tools\"

mkdir $ToolsPath
chdir $ToolsPath

for ($i = 0; $i -lt $sites.count; $i++) {

    Invoke-WebRequest -Uri $sites[$i] -OutFile $names[$i]
    Write-Host $names[$i]"- finished"

}
